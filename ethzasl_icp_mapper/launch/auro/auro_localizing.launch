<?xml version="1.0"?>
<launch>
  <!--This is playing bag files - make sure sim time is used-->
  <param name="use_sim_time" value="true"/>
  <!--Convert velodyne packets from bag files to point clouds for visualization-->

  <!-- Dynamic mapper node-->
  <node name="mapper" type="dynamic_mapper" pkg="ethzasl_icp_mapper" output="screen">
    <remap from="cloud_in" to="/velodyne_points" />
    <param name="localizing" value="true" />
    <param name="mapping" value="false" />
    <param name="finalMapName" value="generatedMap.vtk" />
    <param name="filePath" value="/media/fast_data/MAPPING/" />
    <param name="subscribe_scan" value="false" />
    <param name="icpConfig" value="$(find ethzasl_icp_mapper)/launch/auro/icp_dynamic_outdoor.yaml" />
    <param name="inputFiltersConfig" value="$(find ethzasl_icp_mapper)/launch/auro/input_filters_outdoor.yaml" />
<!--
    <param name="mapPostFiltersConfig" value="$(find ethzasl_icp_mapper)/launch/auro/mapPost_filters_outdoor.yaml" />
-->
    <!--Put that back! -->
    <param name="odom_frame" value="/velodyne" />
    <param name="map_frame" value="/map" />
    <param name="useROSLogger" value="true" />
    <param name="inputQueueSize" value="1" />
    <param name="tfRefreshPeriod" value="0.005" />
    <param name="minOverlap" value="0.6" />
    <param name="maxOverlapToMerge" value="0.99" />
    <param name="minReadingPointCount" value="500" />
    <param name="minMapPointCount" value="10000" />
    <!-- quick fix to have map published each time -->
    <!-- Parameters for dynamic elements -->
    <param name="priorStatic" value="0.8"/>
    <param name="priorDyn" value="0.2"/>
    <param name="maxAngle" value="0.4"/>
    <param name="eps_a" value="0.20"/>
    <param name="eps_d" value="0.1"/>
    <param name="alpha" value="0.99"/>
    <param name="beta" value="0.90"/>
    <param name="maxDyn" value="0.90"/>
    <param name="maxDistNewPoint" value="0.05"/>
  </node>
  <!--rviz-->
  <node name="$(anon rviz)" type="rviz" pkg="rviz" args="-d $(find ethzasl_icp_mapper)/rviz/disp.rviz" output="screen" />

</launch>
